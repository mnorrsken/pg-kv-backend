# Default values for pg-kv-backend
replicaCount: 1

image:
  repository: ghcr.io/mnorrsken/pg-kv-backend
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use
  name: ""

podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext:
  # capabilities:
  #   drop:
  #   - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000

service:
  type: ClusterIP
  port: 6379

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []

resources: {}
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

# Redis server configuration
redis:
  # Address to listen on (inside the container)
  addr: ":6379"
  
  # Redis password configuration
  password:
    # Password value (ignored if existingSecret is set)
    value: ""
    # Use an existing secret for the Redis password
    existingSecret:
      # Name of the existing secret
      name: ""
      # Key in the secret containing the password
      key: "redis-password"

# PostgreSQL connection configuration
postgresql:
  # PostgreSQL host
  host: "postgresql"
  # PostgreSQL port
  port: 5432
  # PostgreSQL database name
  database: "pgkv"
  # PostgreSQL SSL mode (disable, require, verify-ca, verify-full)
  sslmode: "disable"
  
  # Use an existing secret for PostgreSQL credentials
  existingSecret:
    # Name of the existing secret
    name: ""
    # Key in the secret containing the username (optional)
    usernameKey: ""
    # Key in the secret containing the password
    passwordKey: "password"
    # Key in the secret containing the host (optional)
    hostKey: ""
    # Key in the secret containing the port (optional)
    portKey: ""
    # Key in the secret containing the database name (optional)
    dbnameKey: ""
  
  # Authentication configuration
  auth:
    # PostgreSQL username (ignored if existingSecret provides it)
    username: "postgres"
    # PostgreSQL password (ignored if existingSecret is set)
    password: ""

# Additional environment variables
extraEnv: []
  # - name: MY_VAR
  #   value: "my-value"

# Additional environment variables from secrets/configmaps
extraEnvFrom: []
  # - secretRef:
  #     name: my-secret
  # - configMapRef:
  #     name: my-configmap

# Metrics configuration
metrics:
  # Enable metrics endpoint
  enabled: true
  # Metrics server address (inside the container)
  addr: ":9090"
  
  # Metrics service configuration
  service:
    # Port for the metrics service
    port: 9090
    # Annotations for the metrics service
    annotations: {}
  
  # ServiceMonitor configuration (requires Prometheus Operator)
  serviceMonitor:
    # Enable ServiceMonitor creation
    enabled: false
    # Namespace for the ServiceMonitor (defaults to release namespace)
    namespace: ""
    # Labels to add to the ServiceMonitor
    labels: {}
    # Interval at which metrics should be scraped
    interval: "30s"
    # Timeout for scraping metrics
    scrapeTimeout: "10s"
    # Metric relabel configs
    metricRelabelings: []
    # Relabel configs
    relabelings: []
    # Honor labels
    honorLabels: false
